/*
  1) 부서 (나중)
  2) 성명 (나중)
  3) IP
  4) 화면 번호

  생성
  https://jhnyang.tistory.com/307


*/
/*
    생성
*/
CREATE TABLE TEST1
(
     IP VARCHAR(20)
    ,VIEW_NUMBER VARCHAR(20)
)
;

/*
    삽입
*/
-- 10.253.28.1 --
INSERT INTO TEST1
VALUES
(
     '10.253.28.1'
    ,'IBSS6601SVC'
)
;

INSERT INTO TEST1
VALUES
(
     '10.253.28.1'
    ,'IBSS6602SVC'
)
;

INSERT INTO TEST1
VALUES
(
     '10.253.28.1'
    ,'IBSS6603SVC'
)
;
-- 10.253.28.2 --
INSERT INTO TEST1
VALUES
(
     '10.253.28.2'
    ,'IBSS6601SVC'
)
;

INSERT INTO TEST1
VALUES
(
     '10.253.28.2'
    ,'IBSS6602SVC'
)
;

INSERT INTO TEST1
VALUES
(
     '10.253.28.2'
    ,'IBSS6603SVC'
)
;

/*
    SELECT
*/
SELECT 
      T1.IP AS IP
    , SUBSTR(T1.VIEW_NUMBER, 0, 8) AS VIEW_NUM
FROM TEST1 AS T1
;
-- IP, VIEW_NUM --
SELECT 
      T1.IP AS IP
    , SUBSTR(T1.VIEW_NUMBER, 5, 4) AS VIEW_NUM
FROM TEST1 AS T1
;

SELECT
      T1.IP
    , SUM(T1.VIEW_NUMBER)
FROM TEST1 AS T1
GROUP BY T1.IP
;

SELECT 
      SUBSTR(T1.VIEW_NUMBER, 0, 8) AS VIEW_NUM
FROM TEST1 AS T1
GROUP BY VIEW_NUM
;



SELECT 
      T1.IP AS IP
    , SUBSTR(T1.VIEW_NUMBER, 5, 4) AS VIEW_NUM
FROM TEST1 AS T1
;

SELECT
      T1.VIEW_NUMBER
    , COUNT(T1.VIEW_NUMBER)
FROM TEST1 AS T1
GROUP BY T1.VIEW_NUMBER
;